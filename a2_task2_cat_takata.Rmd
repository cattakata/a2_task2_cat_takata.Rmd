---
title: "Assignment 2, Task 2"
author: "Catherine Takata"
date: "2/7/2021"
output: html_document
---

### Overview
Data source: Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year 



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(GGally)
library(broom)
library(jtools)

```

```{r}
# Read in data set locally 

palmetto <- read_csv(here("data", "palmetto.csv"), 
                     col_types = cols(.default = 'c')) %>% 
  mutate(height = as.numeric(height))
```


```{r}
# Data wrangle to isolate specified variables 

palmetto_species <- palmetto %>% 
  select(species, height, length, width, green_lvs) %>% 
  mutate(species_name = case_when(
    species %in% "1" ~ "Serenoa repens",
    species %in% "2" ~ "Sabal etonia"
  )) %>% 
  mutate(species_name = factor(species_name)) %>% 
  mutate(length = as.numeric(length)) %>% 
  mutate(width = as.numeric(width)) %>% 
  mutate(green_lvs = as.numeric(green_lvs))
  
```

A section containing 2 - 3 finalized data visualizations (with figure captions) in which you explore differences in height, canopy length, canopy width, and green leaves for the two species. Add a figure caption to each. Below each data visualization, add a short (~1 sentence) statement with a takeaway from the visualization.

```{r}
ggplot(data = palmetto_species, aes(x = height, y = length)) + 
  geom_point(aes(color = species_name))

ggplot(data = palmetto_species, aes(x = height, y = width)) +
  geom_point(aes(color = species_name))
```

A section in which you perform binary logistic regression using plant height, canopy length, canopy width and green leaves as predictor variables to understand how they relate to probability of a plant being Serenoa repens or Sabal etonia 

The output should be a finalized table containing the binary logistic regression model results (at least coefficients, standard errors for the coefficients, and information for significance - consider using broom::tidy() to get you most of the way). 



```{r}
palmetto_blr <- glm(species_name ~ height + length + width + green_lvs, 
                    data = palmetto_species, 
                    family = "binomial")
```




```{r}
blr_fitted <- palmetto_blr %>% 
  broom::augment(type.predit = "response")
```













